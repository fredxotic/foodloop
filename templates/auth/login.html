{% extends 'base/base_auth.html' %}
{% load static %}

{% block title %}Login - FoodLoop{% endblock %}
{% block auth_heading %}Welcome back to FoodLoop{% endblock %}

{% block content %}
<form method="post" class="space-y-5" x-data="{ showPassword: false }">
    {% csrf_token %}

    <!-- Error Messages -->
    {% if form.errors or form.non_field_errors %}
        <div class="bg-red-50 border-l-4 border-red-500 rounded-lg p-4 flex gap-3 items-start">
            <i class="fas fa-circle-exclamation text-red-500 mt-0.5"></i>
            <div class="flex-1">
                <p class="font-bold text-sm text-red-800 mb-1">Login Failed</p>
                <p class="text-sm text-red-700">
                    {% if form.non_field_errors %}
                        {{ form.non_field_errors.0 }}
                    {% else %}
                        Invalid username or password. Please try again.
                    {% endif %}
                </p>
            </div>
        </div>
    {% endif %}

    <!-- Username/Email Field -->
    <div>
        <label for="username" class="block text-xs font-bold text-slate-600 uppercase tracking-wider mb-2">
            Username or Email <span class="text-red-500">*</span>
        </label>
        <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
                <i class="fas fa-user text-sm"></i>
            </div>
            <input type="text" 
                   id="username" 
                   name="username" 
                   required
                   autofocus
                   value="{{ form.username.value|default:'' }}"
                   class="w-full pl-10 pr-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-brand-500 transition-all text-sm"
                   placeholder="Enter your username or email">
        </div>
    </div>

    <!-- Password Field -->
    <div>
        <div class="flex justify-between items-center mb-2">
            <label for="password" class="block text-xs font-bold text-slate-600 uppercase tracking-wider">
                Password <span class="text-red-500">*</span>
            </label>
            <a href="#" class="text-xs font-bold text-brand-600 hover:text-brand-700 hover:underline">
                Forgot password?
            </a>
        </div>
        <div class="relative">
            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
                <i class="fas fa-lock text-sm"></i>
            </div>
            <input :type="showPassword ? 'text' : 'password'" 
                   id="password" 
                   name="password" 
                   required
                   class="w-full pl-10 pr-12 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-brand-500 transition-all text-sm"
                   placeholder="Enter your password">
            <button type="button" 
                    @click="showPassword = !showPassword"
                    class="absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600 transition-colors">
                <i class="fas" :class="showPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
            </button>
        </div>
    </div>

    <!-- Remember Me Checkbox -->
    <div class="flex items-center gap-3">
        <input type="checkbox" 
               id="remember" 
               name="remember"
               class="w-4 h-4 text-brand-600 border-slate-300 rounded focus:ring-brand-500">
        <label for="remember" class="text-sm text-slate-600 select-none cursor-pointer">
            Keep me signed in for 30 days
        </label>
    </div>

    <!-- Submit Button -->
    <button type="submit" 
            class="w-full bg-brand-600 hover:bg-brand-700 text-white font-bold py-3.5 rounded-xl transition-all hover:shadow-lg hover:-translate-y-0.5 flex items-center justify-center gap-2 text-sm uppercase tracking-wide">
        <i class="fas fa-sign-in-alt"></i>
        Sign In
    </button>
</form>

<!-- Divider -->
<div class="relative my-6">
    <div class="absolute inset-0 flex items-center">
        <div class="w-full border-t border-slate-200"></div>
    </div>
    <div class="relative flex justify-center text-xs uppercase">
        <span class="bg-white px-3 text-slate-500 font-bold tracking-wider">or</span>
    </div>
</div>

<!-- Sign Up Link -->
<div class="text-center">
    <p class="text-sm text-slate-600 mb-4">
        Don't have an account yet?
    </p>
    <a href="{% url 'core:signup' %}" 
       class="inline-flex items-center justify-center gap-2 w-full border-2 border-slate-200 hover:border-brand-500 text-slate-700 hover:text-brand-600 font-bold py-3 rounded-xl transition-all hover:shadow-md text-sm">
        <i class="fas fa-user-plus"></i>
        Create Free Account
    </a>
</div>

<!-- Trust Badges -->
<div class="mt-8 pt-6 border-t border-slate-200">
    <div class="flex items-center justify-center gap-6 text-xs text-slate-500">
        <div class="flex items-center gap-2">
            <i class="fas fa-shield-check text-brand-500"></i>
            <span class="font-medium">Secure Login</span>
        </div>
        <div class="flex items-center gap-2">
            <i class="fas fa-lock text-brand-500"></i>
            <span class="font-medium">Encrypted</span>
        </div>
        <div class="flex items-center gap-2">
            <i class="fas fa-heart text-red-500"></i>
            <span class="font-medium">Free Forever</span>
        </div>
    </div>
</div>

<style>
/* Prevent iOS zoom on input focus */
input {
    font-size: 16px !important;
}

/* Smooth transitions */
input:focus, button:hover {
    transition: all 0.2s ease;
}

/* Autofill styling */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus {
    -webkit-box-shadow: 0 0 0 1000px white inset;
    -webkit-text-fill-color: inherit;
}
</style>
{% endblock %}