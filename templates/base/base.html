{% load static %}
<!DOCTYPE html>
<html lang="en" class="h-full antialiased">
<head>
    <meta charset="UTF-8">
    {% if user.is_authenticated %}
    <meta name="user-id" content="{{ user.id }}">
    <meta name="csrf-token" content="{{ csrf_token }}">
    {% endif %}

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="FoodLoop - Connecting surplus food with communities in need.">
    <meta name="theme-color" content="#0f172a"> <title>{% block title %}FoodLoop{% endblock %}</title>

    <link rel="icon" href="{% static 'images/favicon.png' %}" type="image/png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;700;800&display=swap" rel="stylesheet">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 
                        sans: ['Inter', 'sans-serif'],
                        display: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        brand: { 
                            50: '#f2fcf5', 100: '#e1f8e8', 200: '#c3eed2', 
                            300: '#94e0b3', 400: '#5ac990', 500: '#10b981', 
                            600: '#059669', 700: '#047857', 800: '#065f46', 900: '#064e3b' 
                        },
                        navy: {
                            800: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        }
                    },
                    borderRadius: {
                        'xl': '1rem',
                        '2xl': '1.5rem',
                        '3xl': '2rem',
                    }
                }
            }
        }
    </script>

    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    
    {% block extra_css %}{% endblock %}

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
</head>

<body class="h-full bg-slate-50 font-sans text-slate-900 selection:bg-brand-500 selection:text-white" x-data="{ sidebarOpen: false }">

    <div class="fixed-toast-container" style="position: fixed; top: 20px; right: 20px; z-index: 100; max-width: 90vw;">
        {% if messages %}
            {% for message in messages %}
                <div class="toast toast-{{ message.tags }} glass bg-white p-4 mb-3 rounded-xl shadow-xl border-l-4 {% if message.tags == 'error' %}border-red-500 text-red-600{% else %}border-brand-500 text-brand-700{% endif %} flex items-center gap-3 transform transition-all duration-300" 
                     x-data="{ show: true }" x-show="show" x-init="setTimeout(() => show = false, 4000)"
                     x-transition:enter="transition ease-out duration-300"
                     x-transition:enter-start="opacity-0 translate-x-8"
                     x-transition:enter-end="opacity-100 translate-x-0"
                     x-transition:leave="transition ease-in duration-300"
                     x-transition:leave-start="opacity-100 translate-x-0"
                     x-transition:leave-end="opacity-0 translate-x-8">
                    <i class="fas {% if message.tags == 'error' %}fa-circle-exclamation{% else %}fa-check-circle{% endif %}"></i>
                    <span class="font-medium text-sm">{{ message }}</span>
                </div>
            {% endfor %}
        {% endif %}
    </div>

    <div class="flex h-screen overflow-hidden bg-slate-50">
        {% if user.is_authenticated %}
            {% include 'components/sidebar.html' %}
        {% endif %}

        <div class="flex-1 flex flex-col h-full min-w-0 overflow-hidden relative">
            
            {% include 'components/navbar.html' %}

            <main class="flex-1 overflow-y-auto overflow-x-hidden scroll-smooth relative z-0 flex flex-col">
                <div class="flex-grow p-4 md:p-6 lg:p-8">
                    {% block content %}{% endblock %}
                </div>
                
                {% include 'components/footer.html' %}
            </main>
        </div>
    </div>

    <script src="{% static 'js/scripts.js' %}"></script>
    
    {% if user.is_authenticated %}
        <script src="{% static 'js/notifications.js' %}"></script>
    {% endif %}

    {% block scripts %}{% endblock %}
</body>
</html>