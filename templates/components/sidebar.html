{% load static %}

<div x-show="sidebarOpen" 
     @click="sidebarOpen = false"
     x-transition:enter="transition-opacity ease-linear duration-300"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition-opacity ease-linear duration-300"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     class="fixed inset-0 bg-gray-900/80 z-40 lg:hidden glass-dark"
     style="display: none;"></div>

<div class="fixed lg:sticky top-0 lg:top-16 inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-100 transform transition-transform duration-300 ease-in-out lg:translate-x-0 h-screen lg:h-[calc(100vh-4rem)] overflow-y-auto"
     :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'">
    
    <div class="flex items-center justify-between px-4 py-3 lg:hidden border-b border-gray-100">
        <span class="font-bold text-lg text-gray-900">Menu</span>
        <button @click="sidebarOpen = false" class="text-gray-500 hover:text-gray-700">
            <i class="fas fa-times text-xl"></i>
        </button>
    </div>

    <nav class="p-4 space-y-1">
        <div class="pb-4">
            <p class="px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">Main</p>
            <a href="{% url 'core:dashboard' %}" 
               class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200
               {% if 'dashboard' in request.path %}bg-primary-50 text-primary-700{% else %}text-gray-700 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="fas fa-home w-6 text-lg {% if 'dashboard' in request.path %}text-primary-600{% else %}text-gray-400 group-hover:text-gray-500{% endif %} transition-colors"></i>
                Dashboard
            </a>
        </div>

        <div class="pb-4">
            <p class="px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">
                {% if user.profile.user_type == 'donor' %}Giving{% else %}Receiving{% endif %}
            </p>
            
            {% if user.profile.user_type == 'donor' %}
                <a href="{% url 'core:create_donation' %}" 
                   class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 mb-1
                   {% if 'create' in request.path %}bg-primary-50 text-primary-700{% else %}text-gray-700 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                    <i class="fas fa-plus-circle w-6 text-lg {% if 'create' in request.path %}text-primary-600{% else %}text-gray-400 group-hover:text-gray-500{% endif %}"></i>
                    New Donation
                </a>
                <a href="{% url 'core:my_donations' %}" 
                   class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200
                   {% if 'my-donations' in request.path %}bg-primary-50 text-primary-700{% else %}text-gray-700 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                    <i class="fas fa-list-alt w-6 text-lg {% if 'my-donations' in request.path %}text-primary-600{% else %}text-gray-400 group-hover:text-gray-500{% endif %}"></i>
                    My Donations
                </a>
            {% else %}
                <a href="{% url 'core:search_donations' %}" 
                   class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 mb-1
                   {% if 'search' in request.path %}bg-primary-50 text-primary-700{% else %}text-gray-700 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                    <i class="fas fa-search w-6 text-lg {% if 'search' in request.path %}text-primary-600{% else %}text-gray-400 group-hover:text-gray-500{% endif %}"></i>
                    Find Food
                </a>
                <a href="{% url 'core:my_donations' %}" 
                   class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 mb-1
                   {% if 'my-donations' in request.path %}bg-primary-50 text-primary-700{% else %}text-gray-700 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                    <i class="fas fa-shopping-basket w-6 text-lg {% if 'my-donations' in request.path %}text-primary-600{% else %}text-gray-400 group-hover:text-gray-500{% endif %}"></i>
                    My Claims
                </a>
                <a href="{% url 'core:ai_recommendations' %}" 
                   class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200
                   {% if 'recommendations' in request.path %}bg-purple-50 text-purple-700{% else %}text-gray-700 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                    <i class="fas fa-wand-magic-sparkles w-6 text-lg {% if 'recommendations' in request.path %}text-purple-600{% else %}text-gray-400 group-hover:text-gray-500{% endif %}"></i>
                    AI Matches
                </a>
            {% endif %}
        </div>

        <div class="pb-4">
            <p class="px-3 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2">Insights</p>
            <a href="{% url 'core:map_view' %}" 
               class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 mb-1
               {% if 'map' in request.path %}bg-primary-50 text-primary-700{% else %}text-gray-700 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="fas fa-map-marked-alt w-6 text-lg {% if 'map' in request.path %}text-primary-600{% else %}text-gray-400 group-hover:text-gray-500{% endif %}"></i>
                Map View
            </a>
            <a href="{% url 'core:analytics' %}" 
               class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200
               {% if 'analytics' in request.path %}bg-primary-50 text-primary-700{% else %}text-gray-700 hover:bg-gray-50 hover:text-gray-900{% endif %}">
                <i class="fas fa-chart-pie w-6 text-lg {% if 'analytics' in request.path %}text-primary-600{% else %}text-gray-400 group-hover:text-gray-500{% endif %}"></i>
                Analytics
            </a>
        </div>

        <div class="pt-4 border-t border-gray-100">
            <a href="{% url 'core:profile' %}" 
               class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 text-gray-700 hover:bg-gray-50">
                <div class="w-6 mr-3">
                    {% if user.profile.profile_picture %}
                        <img src="{{ user.profile.profile_picture.url }}" class="w-6 h-6 rounded-full object-cover">
                    {% else %}
                        <div class="w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-xs text-gray-500 font-bold">
                            {{ user.first_name|first|default:"U" }}
                        </div>
                    {% endif %}
                </div>
                My Account
            </a>
            <a href="{% url 'core:logout' %}" class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200 text-red-600 hover:bg-red-50">
                <i class="fas fa-sign-out-alt w-6 text-lg opacity-70"></i>
                Sign Out
            </a>
        </div>
    </nav>
</div>